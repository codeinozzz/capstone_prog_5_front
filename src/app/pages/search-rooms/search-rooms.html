<app-header></app-header>

<div class="rooms-search-page">
  
  <div class="page-header">
    <h2>Search Rooms</h2>
    <p>Find the perfect room for your stay</p>
  </div>

  <app-search-rooms 
    (searchRooms)="onSearchRooms($event)">
  </app-search-rooms>

  <div *ngIf="isSearching && !loading && !error" class="search-info">
    <mat-icon>search</mat-icon>
    <span>
      Search results: {{ rooms.length }} room(s) found
    </span>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Searching for available rooms...</p>
  </div>

  <div *ngIf="error && !loading" class="error-container">
    <mat-icon>error_outline</mat-icon>
    <h3>Search Error</h3>
    <p>{{ error }}</p>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="loadDefaultRooms()">
      <mat-icon>refresh</mat-icon>
      Try Again
    </button>
  </div>

  <div *ngIf="!loading && !error && rooms.length === 0 && isSearching" class="empty-container">
    <mat-icon>hotel_class</mat-icon>
    <h3>No rooms found</h3>
    <p>Try adjusting your search criteria</p>
  </div>

  <div *ngIf="!loading && !error && rooms.length > 0" class="rooms-results">
    
    <div class="results-summary" *ngIf="rooms.length > 0">
      <p>
        {{ rooms.length | number }} 
        {{ rooms.length === 1 ? 'room found' : 'rooms found' }}
      </p>
    </div>

    <div class="rooms-grid">
      <mat-card *ngFor="let room of rooms; trackBy: trackByRoomId" class="room-card">
        
        <mat-card-header>
          <mat-card-title>
            {{ getRoomTypeLabel(room.type) }}
          </mat-card-title>
          <mat-card-subtitle>
            <mat-icon>hotel</mat-icon>
            {{ getHotelName(room) | titlecase }}
          </mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
          
          <div class="room-info">
            <div class="info-item">
              <mat-icon>people</mat-icon>
              <span>Up to {{ room.capacity }} {{ room.capacity === 1 ? 'person' : 'people' }}</span>
            </div>

            <div class="info-item" *ngIf="room.beds">
              <mat-icon>bed</mat-icon>
              <span>{{ room.beds }}</span>
            </div>

            <div class="info-item" *ngIf="getHotelLocation(room) !== 'Location not available'">
              <mat-icon>location_on</mat-icon>
              <span>{{ getHotelLocation(room) | titlecase }}</span>
            </div>

            <div class="info-item" *ngIf="room.amenities?.length">
              <mat-icon>star</mat-icon>
              <span>{{ room.amenities.slice(0, 2).join(', ') }}</span>
            </div>
          </div>

          <div class="room-price">
            <strong>{{ room.price | currency:'USD':'symbol':'1.0-0' }}</strong>
            <small>per night</small>
          </div>

        </mat-card-content>

        <mat-card-actions>
          <button 
            mat-raised-button 
            color="primary" 
            (click)="onReserveRoom(room)"
            class="reserve-btn">
            <mat-icon>book_online</mat-icon>
            Book Now
          </button>
        </mat-card-actions>

      </mat-card>
    </div>
  </div>

</div>

<app-footer></app-footer>